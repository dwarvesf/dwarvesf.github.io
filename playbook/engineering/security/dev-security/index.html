<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content><meta name=description property="og:description" content><meta name=keywords content><meta property="og:type" content="website"><meta property="og:url" content="https://note.d.foundation/playbook/engineering/security/dev-security/"><meta property="og:image" content="https://note.d.foundation/img/LOGO.png"><link rel=icon type=image/x-icon href=https://note.d.foundation/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://note.d.foundation/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://note.d.foundation/favicon-32x32.png><link rel=apple-touch-icon href=https://note.d.foundation/apple-touch-icon.png><title>| Dwarves Foundation</title><meta name=description content><link rel=canonical href=https://note.d.foundation/playbook/engineering/security/dev-security/><link rel="shortcut icon" type=image/png href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNk+A8AAQUBAScY42YAAAAASUVORK5CYII="><script defer data-domain=note.d.foundation src=https://plausible.io/js/script.js></script><style>:root{--primary-color:#e13F5e;--primary-font-color:#ddd;--primary-font-color-light:#333;--main-padding:48px;--column-gap:20px}body{font-family:ibm plex sans,sans-serif;font-size:16px;color:#000;text-rendering:optimizeLegibility;padding:2rem;max-width:100%;margin:0;padding:0;background-color:#fff;line-height:1.5;min-height:100vh;display:flex;flex-direction:column;overflow-wrap:break-word;hyphens:auto}h1,h2,h3,h4{color:var(--primary-font-color)}h1{font-size:45px}h2{font-size:30px}h3{font-size:22px}h4{font-size:15px}q{font-size:20px;max-width:500px;display:block;margin-left:30px}pre{font-family:monospace;background:#000;color:#dadada;padding:15px;border-radius:2px;overflow-x:scroll;width:100%;box-sizing:border-box}pre>code{display:block;text-indent:0;white-space:inherit;font-weight:400}code{font-family:monospace;font-size:12px;background:#000;color:#dadada;padding:2px 5px;white-space:wrap;border-radius:2px;font-weight:700;display:inline-block;line-height:16px;overflow-x:scroll;margin-bottom:-4px}code comment{color:#777}code.button{background:#fff;color:#000;font-size:smaller;display:inline-block;padding:0 6px;font-weight:700;border-radius:2px;line-height:22px}a[href*="#"]{text-decoration:none}.note-title{display:inline-grid;width:100%;max-width:600px;grid-template-areas:"pagetitle pagetitle" "date tags" "authors authors"}.note-title .pagetitle{grid-area:pagetitle}.note-title .date{grid-area:date;color:#636466}.note-title .tags{grid-area:tags;justify-self:right}.note-title .authors{grid-area:authors}.grid{display:inline-grid;grid-template-areas:"title title title" "subtitle subtitle subtitle" "tabmenu tabmenu tabmenu" "nav content pagenav" "nav content pagenav";grid-template-rows:100px 75px 60px 1fr 1fr;grid-template-columns:minmax(0,350px)2fr 1fr;padding-bottom:45px}.grid>*{padding:0 0 0 45px}.grid .title{grid-area:title;color:var(--primary-color)}.grid .subtitle{grid-area:subtitle;font-size:18px;padding-top:16px}.active{color:var(--primary-color);padding-bottom:17px;border-bottom:2px solid var(--primary-color)}nav.tab-menu{grid-area:tabmenu;border-bottom:1px solid #e7e7e7}nav.tab-menu ul{list-style-type:none;padding:0}nav.tab-menu ul li{font-size:16px;font-weight:500;display:inline-block;margin-right:45px}nav.tab-menu ul li a{text-decoration:none;color:inherit}nav.menu{padding:29px 0 0 45px;line-height:22px;margin-top:-2px;white-space:nowrap;grid-area:nav}details{margin-left:-7px;overflow:hidden;font-size:14px;font-weight:500}.section-home{font-size:14px;font-weight:500;line-height:4}summary{padding:5px;display:block;padding-left:24px;position:relative;cursor:pointer}summary:before{content:'';border-width:.4rem;border-style:solid;border-color:transparent transparent transparent #000;position:absolute;top:10px;left:10px;transform:rotate(0);transform-origin:.2rem 50%;transition:.25s transform ease}details[open]>summary:before{transform:rotate(90deg)}details summary::-webkit-details-marker{display:none}details>ul{margin-bottom:0}hr{margin-left:0;max-width:600px}nav .site-nav{display:block}nav .site-nav section{margin-top:-2px}nav .site-nav section h2{margin:20px 0;font-size:24px;text-transform:lowercase}nav.menu ul{padding:0 10px 10px 0;margin:0;list-style-type:none;line-height:22px}main{grid-area:content;padding:var(--main-padding);max-width:100%;box-sizing:border-box}main>ul{line-height:25px;margin:0}main>ul>li>a{text-decoration:underline}.dual-list>ul{columns:2}.single-list>ul{columns:2}.profile img{width:100px;height:100px;object-fit:cover;aspect-ratio:1/1}.profile object{width:100px;height:100px;object-fit:cover;aspect-ratio:1/1}table,th,td{border:1px solid;border-collapse:collapse;border-spacing:0}tr{max-height:100px;max-width:100px}td{padding:0 20px;max-width:300px;max-height:100px;overflow:hidden;text-overflow:ellipsis}td:has(img){padding:0;line-height:0}#TableOfContents>ul>li>a{text-decoration:underline}#TableOfContents>ul{display:grid;column-gap:var(--column-gap);box-sizing:border-box;grid-template-columns:repeat(auto-fill,minmax(var(--nav-sidebar-width),calc(50% - var(--column-gap))));line-height:20px}#TableOfContents li{white-space:nowrap;list-style-type:decimal-leading-zero;list-style-position:inside;overflow:hidden;text-overflow:ellipsis}.notice{padding:20px;border:2px solid #000}main>blockquote{padding:20px;border:2px solid #000}main>*{max-width:600px;margin-bottom:30px}header{padding:var(--main-padding);border-bottom:1px solid #363636}header h1{display:inline}footer{margin-top:auto;padding:var(--main-padding);clear:both}nav .site-nav ul li{list-style-type:none;display:flex;font-variant-numeric:tabular-nums;font-size:14px;padding-left:20px}li:has(input[type=checkbox]){display:block;list-style-type:none}ul:has(li input[type=checkbox]){padding:0}ul li a{overflow:hidden;text-overflow:ellipsis;width:calc(var(--nav-sidebar-width) + var(--nav-sidebar-offset));background-color:#fff}ul li a:hover{white-space:nowrap;width:100%;z-index:10}ul li p{margin-block-end:0;margin-block-start:0}time{padding-right:1rem}blockquote{margin:1em 0;padding:0 2em;border-left:3px solid #eee}img{max-width:100%}video{max-width:100%}a,a:visited{color:#000}@media(prefers-color-scheme:dark){summary:before{border-color:transparent transparent transparent #fff}nav.tab-menu{border-bottom:1px solid #3d3d3d}a,a:visited{color:#dadada}body{background:#1e1e1e;color:#dadada}body a{color:#dadada}pre{background:#fff;color:#1e1e1e}code{background:#fff;color:#1e1e1e}body select{color:#000;background-color:#fff}.project{border-left:2px solid #fff}.notice{border-color:#fff}.mono{filter:invert(1)}.progress>div{background-color:#fff}.progress>div>span{color:#000}main>blockquote{border-color:#fff}ul li a{background-color:inherit}section>ul li a{background-color:inherit}}@media(prefers-color-scheme:light){h1,h2,h3,h4{color:var(--primary-font-color-light)}}@media only screen and (max-width:1100px){:root{--nav-sidebar-width:140px;--nav-sidebar-offset:0px}nav{width:100%}nav .site-nav section{margin:0 10px 10px 0}nav.menu{max-width:100%;box-sizing:border-box;display:inline-block}nav .site-nav{display:grid;column-gap:var(--column-gap);grid-template-columns:repeat(auto-fill,minmax(var(--nav-sidebar-width),1fr))}main{display:inline-block;width:unset}main>*{max-width:100%}ul li a{width:var(--nav-sidebar-width)}}</style><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"playbook","name":"","headline":"","alternativeHeadline":"","description":"Development Security Checklist TRANSMITING INFORMATION Never send credentials unencrypted over public network. Always use encryption (such as HTTPS, SSL, etc.). Don\u0026rsquo;t accept passwords or session tokens over HTTP. Use HTTPS for all web traffic. Use HTTPS in the beginning; it\u0026rsquo;s harder to introduce later. Use HTTPS redirects for HTTP traffic. Use HSTS headers to enforce HTTPS traffic. Use secure cookies. Avoid protocol-relative URLs. STORING INFORMATION Never store secrets (passwords, keys, etc.","inLanguage":"en-us","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/note.d.foundation\/playbook\/engineering\/security\/dev-security\/"},"author":{"@type":"Person","name":"Han Ngo"},"creator":{"@type":"Person","name":"Han Ngo"},"accountablePerson":{"@type":"Person","name":"Han Ngo"},"copyrightHolder":"Dwarves Foundation","copyrightYear":"0001","date":"0001-01-01T00:00:00.00Z","dateCreated":"0001-01-01T00:00:00.00Z","datePublished":"0001-01-01T00:00:00.00Z","dateModified":"0001-01-01T00:00:00.00Z","publisher":{"@type":"Organization","name":"Dwarves Foundation","url":"https://note.d.foundation/","logo":{"@type":"ImageObject","url":"https:\/\/note.d.foundation\/","width":"32","height":"32"}},"image":"https://note.d.foundation/","url":"https:\/\/note.d.foundation\/playbook\/engineering\/security\/dev-security\/","wordCount":"1166","genre":[],"keywords":[]}</script><style>body{visibility:hidden;opacity:0}</style><noscript><style>body{visibility:visible;opacity:1}</style></noscript><script type=text/javascript>window.addEventListener("DOMContentLoaded",function(){document.body.style.visibility="visible",document.body.style.opacity=1})</script></head><body class=playbook><div class=grid><h1 class=title><a style=color:inherit;text-decoration:none href=/site-index>Dwarves Notes</a></h1><div class=subtitle>A collection of notes for everything we do and operate at Dwarves.</div><nav class=tab-menu><ul><li><a href=/>Home</a></li><li><a href=/guild>Guild</a></li><li><a href=/memo>Memo</a></li><li><a href=https://brain.d.foundation/>Brainery</a></li><li><a href=/newsletter>Newsletter</a></li><li><a href=/site-index>Index</a></li></ul></details></nav><nav class=menu><section class=site-nav></section></nav><main><div class=note-title><h1 class=pagetitle></h1><div class=date>Jan 1, 0001</div><div class=tags>Tags:</div></div><hr><h1 id=development-security-checklist><a href=#development-security-checklist>Development Security Checklist <a href=#development-security-checklist></a></a></h1><h5 id=transmiting-information><a href=#transmiting-information>TRANSMITING INFORMATION <a href=#transmiting-information></a></a></h5><ul><li><input disabled type=checkbox> Never send credentials unencrypted over public network. Always use encryption (such as HTTPS, SSL, etc.).</li><li><input disabled type=checkbox> Don&rsquo;t accept passwords or session tokens over HTTP.</li><li><input disabled type=checkbox> Use HTTPS for all web traffic.</li><li><input disabled type=checkbox> Use HTTPS in the beginning; it&rsquo;s harder to introduce later.</li><li><input disabled type=checkbox> Use HTTPS redirects for HTTP traffic.</li><li><input disabled type=checkbox> Use <a href=http://tools.ietf.org/html/rfc6797>HSTS</a> headers to enforce HTTPS
traffic.</li><li><input disabled type=checkbox> Use secure cookies.</li><li><input disabled type=checkbox> Avoid protocol-relative URLs.</li></ul><h5 id=storing-information><a href=#storing-information>STORING INFORMATION <a href=#storing-information></a></a></h5><ul><li><input disabled type=checkbox> Never store secrets (passwords, keys, etc.) in the sources in version control.</li><li><input disabled type=checkbox> Don&rsquo;t log passwords.</li><li><input disabled type=checkbox> Don&rsquo;t store passwords in plain text.</li><li><input disabled type=checkbox> Don&rsquo;t hash passwords using a reversible cipher.</li><li><input disabled type=checkbox> Don&rsquo;t hash passwords using a broken cipher, such as MD5 or SHA1.</li></ul><h5 id=logging><a href=#logging>LOGGING <a href=#logging></a></a></h5><ul><li><input disabled type=checkbox> For applications handling sensitive data, it&rsquo;s good to maintain audit logging—storing a sequence of actions/events that took place in the system, together with the event/source originator.</li><li><input disabled type=checkbox> Data should be anonymized as much as possible. Avoid logging personally identifiable information, for example user’s name.</li><li><input disabled type=checkbox> If you must log sensitive information try hashing before logging so you can identify the same entity between different parts of the processing.</li></ul><h5 id=docker><a href=#docker>DOCKER <a href=#docker></a></a></h5><p><strong>Using Docker will not make your service more secure.</strong> Generally, you should consider at least following things if using Docker:</p><ul><li><input disabled type=checkbox> Don&rsquo;t run any untrusted binaries inside Docker containers</li><li><input disabled type=checkbox> Create unprivileged users inside Docker containers and run binaries using unprivileged user instead of root whenever possible</li><li><input disabled type=checkbox> Periodically rebuild and redeploy your containers with updated libraries and dependencies</li><li><input disabled type=checkbox> Periodically update (or rebuild) your Docker hosts with latest security updates</li><li><input disabled type=checkbox> Multiple containers running on same host will by default have some level of access to other containers and the host itself. Properly secure all hosts, and run containers with a minimum set of capabilities, for example preventing network access if they don&rsquo;t need it.</li></ul><h5 id=authentication-systems-signupsignin2-factorpassword-reset><a href=#authentication-systems-signupsignin2-factorpassword-reset>AUTHENTICATION SYSTEMS (Signup/Signin/2 Factor/Password reset) <a href=#authentication-systems-signupsignin2-factorpassword-reset></a></a></h5><ul><li><input disabled type=checkbox> Use HTTPS everywhere. Never send credentials unencrypted over public network.</li><li><input disabled type=checkbox> Store password hashes using <code>Bcrypt</code> (no salt necessary - <code>Bcrypt</code> does it for you).</li><li><input disabled type=checkbox> Destroy the session identifier after <code>logout</code>.</li><li><input disabled type=checkbox> Destroy all active sessions on reset password (or offer to).</li><li><input disabled type=checkbox> Must have the <code>state</code> parameter in OAuth2.</li><li><input disabled type=checkbox> No open redirects after successful login or in any other intermediate redirects.</li><li><input disabled type=checkbox> When parsing Signup/Login input, sanitize for javascript://, data://, CRLF characters.</li><li><input disabled type=checkbox> Set secure, httpOnly cookies.</li><li><input disabled type=checkbox> In Mobile <code>OTP</code> based mobile verification, do not send the OTP back in the response when <code>generate OTP</code> or <code>Resend OTP</code> API is called.</li><li><input disabled type=checkbox> Limit attempts to <code>Login</code>, <code>Verify OTP</code>, <code>Resend OTP</code> and <code>generate OTP</code> APIs for a particular user. Have an exponential backoff set or/and something like a captcha based challenge.</li><li><input disabled type=checkbox> Lock a user account for specific time after a given number of failed attempts</li><li><input disabled type=checkbox> Check for randomness of reset password token in the emailed link or SMS.</li><li><input disabled type=checkbox> Set an expiration on the reset password token for a reasonable period.</li><li><input disabled type=checkbox> Expire the reset token after it has been successfully used.</li></ul><h5 id=user-data--authorization><a href=#user-data--authorization>USER DATA & AUTHORIZATION <a href=#user-data--authorization></a></a></h5><ul><li><input disabled type=checkbox> Any resource access like, <code>my cart</code>, <code>my history</code> should check the logged in user&rsquo;s ownership of the resource using session id.</li><li><input disabled type=checkbox> Serially iterable resource id should be avoided. Use <code>/me/orders</code> instead of <code>/user/37153/orders</code>. This acts as a sanity check in case you forgot to check for authorization token.</li><li><input disabled type=checkbox> <code>Edit email/phone number</code> feature should be accompanied by a verification email to the owner of the account.</li><li><input disabled type=checkbox> Any upload feature should sanitize the filename provided by the user. Also, for generally reasons apart from security, upload to something like S3 (and post-process using lambda) and not your own server capable of executing code.</li><li><input disabled type=checkbox> <code>Profile photo upload</code> feature should sanitize all the <code>EXIF</code> tags also if not required.</li><li><input disabled type=checkbox> For user ids and other ids, use <a href=http://www.ietf.org/rfc/rfc4122.txt>RFC compliant</a> <code>UUID</code> instead of integers. You can find an implementation for this for your language on Github.</li><li><input disabled type=checkbox> JWT are awesome. Use them if required for your single page app/APIs.</li></ul><h5 id=sanitization-of-input><a href=#sanitization-of-input>SANITIZATION OF INPUT <a href=#sanitization-of-input></a></a></h5><ul><li><input disabled type=checkbox> <code>Sanitize</code> all user inputs or any input parameters exposed to user to prevent <a href=https://en.wikipedia.org/wiki/Cross-site_scripting>XSS</a>.</li><li><input disabled type=checkbox> Always use parameterized queries to prevent <a href=https://en.wikipedia.org/wiki/SQL_injection>SQL Injection</a>.</li><li><input disabled type=checkbox> Sanitize user input if using it directly for functionalities like CSV import.</li><li><input disabled type=checkbox> <code>Sanitize</code> user input for special cases like robots.txt as profile names in case you are using a url pattern like coolcorp.io/username.</li><li><input disabled type=checkbox> Do not hand code or build JSON by string concatenation ever, no matter how small the object is. Use your language defined libraries or framework.</li><li><input disabled type=checkbox> Sanitize inputs that take some sort of URLs to prevent <a href="https://docs.google.com/document/d/1v1TkWZtrhzRLy0bYXBcdLUedXGb9njTNIJXa3u9akHM/edit#heading=h.t4tsk5ixehdd">SSRF</a>.</li><li><input disabled type=checkbox> Sanitize Outputs before displaying to users.</li></ul><h5 id=android--ios-app><a href=#android--ios-app>ANDROID / IOS APP <a href=#android--ios-app></a></a></h5><ul><li><input disabled type=checkbox> <code>salt</code> from payment gateways should not be hardcoded.</li><li><input disabled type=checkbox> <code>secret</code> / <code>auth token</code> from 3rd party SDK&rsquo;s should not be hardcoded.</li><li><input disabled type=checkbox> API calls intended to be done <code>server to server</code> should not be done from the app.</li><li><input disabled type=checkbox> In Android, all the granted <a href=https://developer.android.com/guide/topics/security/permissions.html>permissions</a> should be carefully evaluated.</li><li><input disabled type=checkbox> On iOS, store sensitive information (authentication tokens, API keys, etc.) in the system keychain. Do <strong>not</strong> store this kind of information in the user defaults.</li><li><input disabled type=checkbox> <a href=https://en.wikipedia.org/wiki/HTTP_Public_Key_Pinning>Certificate pinning</a> is highly recommended.</li></ul><h5 id=security-headers--configurations><a href=#security-headers--configurations>SECURITY HEADERS & CONFIGURATIONS <a href=#security-headers--configurations></a></a></h5><ul><li><input disabled type=checkbox> <code>Add</code> <a href=https://en.wikipedia.org/wiki/Content_Security_Policy>CSP</a> header to mitigate XSS and data injection attacks. This is important.</li><li><input disabled type=checkbox> <code>Add</code> <a href=https://en.wikipedia.org/wiki/Cross-site_request_forgery>CSRF</a> header to prevent cross site request forgery. Also add <a href=https://tools.ietf.org/html/draft-ietf-httpbis-cookie-same-site-00>SameSite</a> attributes on cookies.</li><li><input disabled type=checkbox> <code>Add</code> <a href=https://en.wikipedia.org/wiki/HTTP_Strict_Transport_Security>HSTS</a> header to prevent SSL stripping attack.</li><li><input disabled type=checkbox> <code>Add</code> your domain to the <a href=https://hstspreload.org/>HSTS Preload List</a></li><li><input disabled type=checkbox> <code>Add</code> <a href=https://en.wikipedia.org/wiki/Clickjacking#X-Frame-Options>X-Frame-Options</a> to protect against Clickjacking.</li><li><input disabled type=checkbox> <code>Add</code> <a href=https://www.owasp.org/index.php/OWASP_Secure_Headers_Project#X-XSS-Protection>X-XSS-Protection</a> header to mitigate XSS attacks.</li><li><input disabled type=checkbox> Update DNS records to add <a href=https://en.wikipedia.org/wiki/Sender_Policy_Framework>SPF</a> record to mitigate spam and phishing attacks.</li><li><input disabled type=checkbox> Add <a href=https://en.wikipedia.org/wiki/Subresource_Integrity>subresource integrity checks</a> if loading your JavaScript libraries from a third party CDN. For extra security, add the <a href=https://w3c.github.io/webappsec-subresource-integrity/#parse-require-sri-for>require-sri-for</a> CSP-directive so you don&rsquo;t load resources that don&rsquo;t have an SRI sat.</li><li><input disabled type=checkbox> Use random CSRF tokens and expose business logic APIs as HTTP POST requests. Do not expose CSRF tokens over HTTP for example in an initial request upgrade phase.</li><li><input disabled type=checkbox> Do not use critical data or tokens in GET request parameters. Exposure of server logs or a machine/stack processing them would expose user data in turn.</li></ul><h5 id=operations><a href=#operations>OPERATIONS <a href=#operations></a></a></h5><ul><li><input disabled type=checkbox> If you are small and inexperienced, evaluate using AWS elasticbeanstalk or a PaaS to run your code.</li><li><input disabled type=checkbox> Use a decent provisioning script to create VMs in the cloud.</li><li><input disabled type=checkbox> Check for machines with unwanted publicly <code>open ports</code>.</li><li><input disabled type=checkbox> Check for no/default passwords for <code>databases</code> especially MongoDB & Redis.</li><li><input disabled type=checkbox> Use SSH to access your machines; do not setup a password, use SSH key-based authentication instead.</li><li><input disabled type=checkbox> Install updates timely to act upon zero day vulnerabilities like Heartbleed, Shellshock.</li><li><input disabled type=checkbox> Modify server config to use TLS 1.2 for HTTPS and disable all other schemes. (The tradeoff is good.)</li><li><input disabled type=checkbox> Do not leave the DEBUG mode on. In some frameworks, DEBUG mode can give access full-fledged REPL or shells or expose critical data in error messages stacktraces.</li><li><input disabled type=checkbox> Be prepared for bad actors & DDOS - use a hosting service that has DDOS mitigation.</li><li><input disabled type=checkbox> Set up monitoring for your systems, and log stuff (use <a href=https://newrelic.com/>New Relic</a> or something like that).</li><li><input disabled type=checkbox> If developing for enterprise customers, adhere to compliance requirements. If AWS S3, consider using the feature to <a href=http://docs.aws.amazon.com/AmazonS3/latest/dev/UsingServerSideEncryption.html>encrypt data</a>. If using AWS EC2, consider using the feature to use encrypted volumes (even boot volumes can be encrypted now).</li><li><input disabled type=checkbox> Set up <a href=https://github.com/Netflix/Scumblr>Netflix&rsquo;s Scumblr</a> to hear about talks about your organization on social platforms and Google search.</li></ul></main></div></body></html>