<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content><meta name=description property="og:description" content><meta name=keywords content><meta property="og:type" content="website"><meta property="og:url" content="https://log.console.so/playbook/engineering/security/api-security/"><meta property="og:image" content="https://log.console.so/img/ConsoleLabs_logo_1.jpg"><link rel=icon type=image/x-icon href=https://log.console.so/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://log.console.so/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://log.console.so/favicon-32x32.png><link rel=apple-touch-icon href=https://log.console.so/apple-touch-icon.png><title>| Console Labs</title><meta name=description content><link rel=canonical href=https://log.console.so/playbook/engineering/security/api-security/><link rel="shortcut icon" type=image/png href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNk+A8AAQUBAScY42YAAAAASUVORK5CYII="><script defer data-domain=log.console.so src=https://plausible.io/js/script.js></script><style>:root{--primary-color:#45f1a6;--primary-color-light:#2ea370;--nav-sidebar-width:200px;--nav-sidebar-offset:40px;--main-padding:45px;--column-gap:20px}body{font:16px sans-serif;color:#000;text-rendering:optimizeLegibility;padding:2rem;max-width:100%;margin:0;padding:0;background-color:#fff;line-height:25px;min-height:100vh;display:flex;flex-direction:column;overflow-wrap:break-word;hyphens:auto}h1,h2,h3,h4{color:var(--primary-color)}h1{font-size:45px;display:none}h2{font-size:30px}h3{font-size:20px}h4{font-size:15px}q{font-size:20px;max-width:500px;display:block;margin-left:30px}pre{font-family:monospace;background:#000;color:#fff;padding:15px;border-radius:2px;overflow-x:scroll;width:100%;box-sizing:border-box}pre>code{display:block;text-indent:0;white-space:inherit;font-weight:400}code{font-family:monospace;font-size:12px;background:#000;color:#fff;padding:2px 5px;white-space:wrap;border-radius:2px;font-weight:700;display:inline-block;line-height:16px;overflow-x:scroll}code comment{color:#777}code.button{background:#fff;color:#000;font-size:smaller;display:inline-block;padding:0 6px;font-weight:700;border-radius:2px;line-height:22px}a[href*="#"]{text-decoration:none}nav.menu{float:left;padding:var(--main-padding);max-width:var(--nav-sidebar-width);line-height:22px;margin-top:-2px;white-space:nowrap}nav .site-nav{margin:20px 0;display:block}nav .site-nav section{float:left;margin-top:-2px}nav .site-nav section h2{margin:20px 0;font-size:24px;text-transform:lowercase}nav.menu details summary{margin-bottom:30px}nav.menu ul{padding:0 10px 10px 0;margin:0;list-style-type:none;line-height:22px}main{padding:var(--main-padding);max-width:100%;box-sizing:border-box;float:left}main>ul{line-height:25px;margin:0}main>ul>li>a{text-decoration:underline}.dual-list>ul{columns:2}.single-list>ul{columns:2}.profile img{width:100px;height:100px;object-fit:cover;aspect-ratio:1/1}.profile object{width:100px;height:100px;object-fit:cover;aspect-ratio:1/1}table,th,td{border:1px solid;border-collapse:collapse;border-spacing:0}tr{max-height:100px;max-width:100px}td{padding:0 20px;max-width:300px;max-height:100px;overflow:hidden;text-overflow:ellipsis}td:has(img){padding:0;line-height:0}#TableOfContents>ul>li>a{text-decoration:underline}#TableOfContents>ul{display:grid;column-gap:var(--column-gap);box-sizing:border-box;grid-template-columns:repeat(auto-fill,minmax(var(--nav-sidebar-width),calc(50% - var(--column-gap))));line-height:20px}#TableOfContents li{white-space:nowrap;list-style-type:decimal-leading-zero;list-style-position:inside;overflow:hidden;text-overflow:ellipsis}.notice{padding:20px;border:2px solid #000}main>blockquote{padding:20px;border:2px solid #000}main>*{max-width:600px;margin-bottom:30px}header{padding:var(--main-padding);border-bottom:1px solid #222}header a img{filter:invert(0)}header h1{display:inline}footer{margin-top:auto;padding:var(--main-padding);clear:both}nav .site-nav ul li{list-style-type:none;display:flex;font-variant-numeric:tabular-nums}li:has(input[type=checkbox]){display:block;list-style-type:none}ul:has(li input[type=checkbox]){padding:0}ul li a{overflow:hidden;text-overflow:ellipsis;width:calc(var(--nav-sidebar-width) + var(--nav-sidebar-offset));background-color:#fff}ul li a:hover{white-space:nowrap;width:100%;z-index:10}ul li p{margin-block-end:0;margin-block-start:0}time{padding-right:1rem}blockquote{margin:1em 0;padding:0 2em;border-left:3px solid #eee}img{max-width:100%}a,a:visited{color:#000}@media(prefers-color-scheme:dark){a,a:visited{color:#fff}body{background:#000;color:#fff}header a img{filter:invert(1)}body a{color:#fff}pre{background:#fff;color:#000}code{background:#fff;color:#000}body select{color:#000;background-color:#fff}.project{border-left:2px solid #fff}.notice{border-color:#fff}.mono{filter:invert(1)}.progress>div{background-color:#fff}.progress>div>span{color:#000}main>blockquote{border-color:#fff}ul li a{background-color:inherit}section>ul li a{background-color:inherit}}@media(prefers-color-scheme:light){h1,h2,h3,h4{color:var(--primary-color-light)}}@media only screen and (max-width:1100px){:root{--nav-sidebar-width:140px;--nav-sidebar-offset:0px}nav{width:100%}nav .site-nav section{float:left;margin:0 10px 10px 0}nav.menu{max-width:100%;box-sizing:border-box;display:inline-block}nav .site-nav{display:grid;column-gap:var(--column-gap);grid-template-columns:repeat(auto-fill,minmax(var(--nav-sidebar-width),1fr))}main{display:inline-block;width:unset}main>*{max-width:100%}ul li a{width:var(--nav-sidebar-width)}}</style><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"playbook","name":"","headline":"","alternativeHeadline":"","description":"API Security Checklist Authentication Consider not using Basic Auth. Use standard authentication (e.g. JWT, OAuth). Don\u0026rsquo;t reinvent the wheel in Authentication, token generation, password storage. Use the standards. Use Max Retry and jail features in Login. Use encryption on all sensitive data. JWT (JSON Web Token) Use a random complicated key (JWT Secret) to make brute forcing the token very hard. Don\u0026rsquo;t extract the algorithm from the payload. Force the algorithm in the backend (HS256 or RS256).","inLanguage":"en-us","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/log.console.so\/playbook\/engineering\/security\/api-security\/"},"author":{"@type":"Person","name":"Han Ngo"},"creator":{"@type":"Person","name":"Han Ngo"},"accountablePerson":{"@type":"Person","name":"Han Ngo"},"copyrightHolder":"Console Labs","copyrightYear":"0001","date":"0001-01-01T00:00:00.00Z","dateCreated":"0001-01-01T00:00:00.00Z","datePublished":"0001-01-01T00:00:00.00Z","dateModified":"0001-01-01T00:00:00.00Z","publisher":{"@type":"Organization","name":"Console Labs","url":"https://log.console.so/","logo":{"@type":"ImageObject","url":"https:\/\/log.console.so\/","width":"32","height":"32"}},"image":"https://log.console.so/","url":"https:\/\/log.console.so\/playbook\/engineering\/security\/api-security\/","wordCount":"512","genre":[],"keywords":[]}</script><style>body{visibility:hidden;opacity:0}</style><noscript><style>body{visibility:visible;opacity:1}</style></noscript><script type=text/javascript>window.addEventListener("DOMContentLoaded",function(){document.body.style.visibility="visible",document.body.style.opacity=1})</script></head><body class=playbook><header><a href=/><img src=https://log.console.so/img/ConsoleLabs_logo.png alt=ConsoleLabs height=103px style="margin:-28px -26px"></a></header><div><nav class=menu><details open><summary>Menu</summary><section class=site-nav><section><ul><li><a href=/site-index/>Index</a></li></ul></section><section><h2>experiments</h2><ul></ul></section><section><h2>blog</h2><ul></ul></section><section><h2>playbook</h2><ul></ul></section></section></details></nav><main><h1 id=api-security-checklist><a href=#api-security-checklist>API Security Checklist <a href=#api-security-checklist></a></a></h1><h2 id=authentication><a href=#authentication>Authentication <a href=#authentication></a></a></h2><ul><li><input disabled type=checkbox> Consider not using <code>Basic Auth</code>. Use standard authentication (e.g. <a href=https://jwt.io/>JWT</a>, <a href=https://oauth.net/>OAuth</a>).</li><li><input disabled type=checkbox> Don&rsquo;t reinvent the wheel in <code>Authentication</code>, <code>token generation</code>, <code>password storage</code>. Use the standards.</li><li><input disabled type=checkbox> Use <code>Max Retry</code> and jail features in Login.</li><li><input disabled type=checkbox> Use encryption on all sensitive data.</li></ul><h3 id=jwt-json-web-token><a href=#jwt-json-web-token>JWT (JSON Web Token) <a href=#jwt-json-web-token></a></a></h3><ul><li><input disabled type=checkbox> Use a random complicated key (<code>JWT Secret</code>) to make brute forcing the token very hard.</li><li><input disabled type=checkbox> Don&rsquo;t extract the algorithm from the payload. Force the algorithm in the backend (<code>HS256</code> or <code>RS256</code>).</li><li><input disabled type=checkbox> Make token expiration (<code>TTL</code>, <code>RTTL</code>) as short as possible.</li><li><input disabled type=checkbox> Don&rsquo;t store sensitive data in the JWT payload, it can be decoded <a href=https://jwt.io/#debugger-io>easily</a>.</li></ul><h3 id=oauth><a href=#oauth>OAuth <a href=#oauth></a></a></h3><ul><li><input disabled type=checkbox> Always validate <code>redirect_uri</code> server-side to allow only whitelisted URLs.</li><li><input disabled type=checkbox> Always try to exchange for code and not tokens (don&rsquo;t allow <code>response_type=token</code>).</li><li><input disabled type=checkbox> Use <code>state</code> parameter with a random hash to prevent CSRF on the OAuth authentication process.</li><li><input disabled type=checkbox> Define the default scope, and validate scope parameters for each application.</li></ul><h2 id=access><a href=#access>Access <a href=#access></a></a></h2><ul><li><input disabled type=checkbox> Limit requests (Throttling) to avoid DDoS / brute-force attacks.</li><li><input disabled type=checkbox> Use HTTPS on server side to avoid MITM (Man in the Middle Attack).</li><li><input disabled type=checkbox> Use <code>HSTS</code> header with SSL to avoid SSL Strip attack.</li></ul><h2 id=input><a href=#input>Input <a href=#input></a></a></h2><ul><li><input disabled type=checkbox> Use the proper HTTP method according to the operation: <code>GET (read)</code>, <code>POST (create)</code>, <code>PUT/PATCH (replace/update)</code>, and <code>DELETE (to delete a record)</code>, and respond with <code>405 Method Not Allowed</code> if the requested method isn&rsquo;t appropriate for the requested resource.</li><li><input disabled type=checkbox> Validate <code>content-type</code> on request Accept header (Content Negotiation) to allow only your supported format (e.g. <code>application/xml</code>, <code>application/json</code>, etc.) and respond with <code>406 Not Acceptable</code> response if not matched.</li><li><input disabled type=checkbox> Validate <code>content-type</code> of posted data as you accept (e.g. <code>application/x-www-form-urlencoded</code>, <code>multipart/form-data</code>, <code>application/json</code>, etc.).</li><li><input disabled type=checkbox> Validate user input to avoid common vulnerabilities (e.g. <code>XSS</code>, <code>SQL-Injection</code>, <code>Remote Code Execution</code>, etc.).</li><li><input disabled type=checkbox> Don&rsquo;t use any sensitive data (<code>credentials</code>, <code>Passwords</code>, <code>security tokens</code>, or <code>API keys</code>) in the URL, but use standard Authorization header.</li><li><input disabled type=checkbox> Use an API Gateway service to enable caching, Rate Limit policies (e.g. <code>Quota</code>, <code>Spike Arrest</code>, or <code>Concurrent Rate Limit</code>) and deploy APIs resources dynamically.</li></ul><h2 id=processing><a href=#processing>Processing <a href=#processing></a></a></h2><ul><li><input disabled type=checkbox> Check if all the endpoints are protected behind authentication to avoid broken authentication process.</li><li><input disabled type=checkbox> User own resource ID should be avoided. Use <code>/me/orders</code> instead of <code>/user/654321/orders</code>.</li><li><input disabled type=checkbox> Don&rsquo;t auto-increment IDs. Use <code>UUID</code> instead.</li><li><input disabled type=checkbox> If you are parsing XML files, make sure entity parsing is not enabled to avoid <code>XXE</code> (XML external entity attack).</li><li><input disabled type=checkbox> If you are parsing XML files, make sure entity expansion is not enabled to avoid <code>Billion Laughs/XML bomb</code> via exponential entity expansion attack.</li><li><input disabled type=checkbox> Use a CDN for file uploads.</li><li><input disabled type=checkbox> If you are dealing with huge amount of data, use Workers and Queues to process as much as possible in background and return response fast to avoid HTTP Blocking.</li><li><input disabled type=checkbox> Do not forget to turn the DEBUG mode OFF.</li></ul><h2 id=output><a href=#output>Output <a href=#output></a></a></h2><ul><li><input disabled type=checkbox> Send <code>X-Content-Type-Options: nosniff</code> header.</li><li><input disabled type=checkbox> Send <code>X-Frame-Options: deny</code> header.</li><li><input disabled type=checkbox> Send <code>Content-Security-Policy: default-src 'none'</code> header.</li><li><input disabled type=checkbox> Remove fingerprinting headers - <code>X-Powered-By</code>, <code>Server</code>, <code>X-AspNet-Version</code>, etc.</li><li><input disabled type=checkbox> Force <code>content-type</code> for your response, if you return <code>application/json</code> then your response <code>content-type</code> is <code>application/json</code>.</li><li><input disabled type=checkbox> Don&rsquo;t return sensitive data like <code>credentials</code>, <code>Passwords</code>, or <code>security tokens</code>.</li><li><input disabled type=checkbox> Return the proper status code according to the operation completed. (e.g. <code>200 OK</code>, <code>400 Bad Request</code>, <code>401 Unauthorized</code>, <code>405 Method Not Allowed</code>, etc.).</li></ul><p>Source: <a href=https://github.com/shieldfy/API-Security-Checklist>API Security Checklist</a></p></main></div></body></html><footer><hr><span style=float:right>Edited on Jan 1, 0001<br></span><b>Console Labs</b> © 2023 — <a href=https://github.com/consolelabs/consolelabs.github.io/blob/main/LICENSE.by-nc-sa-4.0.md target=_blank>BY-NC-SA 4.0</a></footer>