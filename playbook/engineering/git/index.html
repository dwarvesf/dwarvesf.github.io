<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content><meta name=description property="og:description" content><meta name=keywords content><meta property="og:type" content="website"><meta property="og:url" content="https://note.d.foundation/playbook/engineering/git/"><meta property="og:image" content="https://note.d.foundation/img/LOGO.png"><link rel=icon type=image/x-icon href=https://note.d.foundation/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://note.d.foundation/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://note.d.foundation/favicon-32x32.png><link rel=apple-touch-icon href=https://note.d.foundation/apple-touch-icon.png><title>| Dwarves Foundation</title><meta name=description content><link rel=canonical href=https://note.d.foundation/playbook/engineering/git/><link rel="shortcut icon" type=image/png href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNk+A8AAQUBAScY42YAAAAASUVORK5CYII="><script defer data-domain=note.d.foundation src=https://plausible.io/js/script.js></script><style>:root{--primary-color:#dadada;--primary-color-light:#2ea370;--main-padding:48px;--column-gap:20px}body{font:16px sans-serif;color:#000;text-rendering:optimizeLegibility;padding:2rem;max-width:100%;margin:0;padding:0;background-color:#fff;line-height:25px;min-height:100vh;display:flex;flex-direction:column;overflow-wrap:break-word;hyphens:auto}h1,h2,h3,h4{color:var(--primary-color)}h1{font-size:45px;display:none}h2{font-size:30px}h3{font-size:22px}h4{font-size:15px}q{font-size:20px;max-width:500px;display:block;margin-left:30px}pre{font-family:monospace;background:#000;color:#dadada;padding:15px;border-radius:2px;overflow-x:scroll;width:100%;box-sizing:border-box}pre>code{display:block;text-indent:0;white-space:inherit;font-weight:400}code{font-family:monospace;font-size:12px;background:#000;color:#dadada;padding:2px 5px;white-space:wrap;border-radius:2px;font-weight:700;display:inline-block;line-height:16px;overflow-x:scroll;margin-bottom:-4px}code comment{color:#777}code.button{background:#fff;color:#000;font-size:smaller;display:inline-block;padding:0 6px;font-weight:700;border-radius:2px;line-height:22px}a[href*="#"]{text-decoration:none}.grid{display:inline-grid;grid-template-areas:"nav content" "nav content";grid-template-rows:1fr 100vh;grid-template-columns:325px 1fr}nav.menu{padding:29px 0 0 45px;max-width:var(--nav-sidebar-width);line-height:22px;margin-top:-2px;white-space:nowrap;border-right:1px solid #363636;grid-area:nav}details{margin-left:-7px;overflow:hidden;font-size:14px;font-weight:500}summary{padding:5px;display:block;padding-left:24px;position:relative;cursor:pointer}summary:before{content:'';border-width:.4rem;border-style:solid;border-color:transparent transparent transparent #fff;position:absolute;top:10px;left:10px;transform:rotate(0);transform-origin:.2rem 50%;transition:.25s transform ease}details[open]>summary:before{transform:rotate(90deg)}details summary::-webkit-details-marker{display:none}details>ul{margin-bottom:0}hr{margin-left:0}nav .site-nav{margin:20px 0;display:block}nav .site-nav section{margin-top:-2px}nav .site-nav section h2{margin:20px 0;font-size:24px;text-transform:lowercase}nav.menu ul{padding:0 10px 10px 0;margin:0;list-style-type:none;line-height:22px}main{grid-area:content;padding:var(--main-padding);max-width:100%;box-sizing:border-box}main>ul{line-height:25px;margin:0}main>ul>li>a{text-decoration:underline}.dual-list>ul{columns:2}.single-list>ul{columns:2}.profile img{width:100px;height:100px;object-fit:cover;aspect-ratio:1/1}.profile object{width:100px;height:100px;object-fit:cover;aspect-ratio:1/1}table,th,td{border:1px solid;border-collapse:collapse;border-spacing:0}tr{max-height:100px;max-width:100px}td{padding:0 20px;max-width:300px;max-height:100px;overflow:hidden;text-overflow:ellipsis}td:has(img){padding:0;line-height:0}#TableOfContents>ul>li>a{text-decoration:underline}#TableOfContents>ul{display:grid;column-gap:var(--column-gap);box-sizing:border-box;grid-template-columns:repeat(auto-fill,minmax(var(--nav-sidebar-width),calc(50% - var(--column-gap))));line-height:20px}#TableOfContents li{white-space:nowrap;list-style-type:decimal-leading-zero;list-style-position:inside;overflow:hidden;text-overflow:ellipsis}.notice{padding:20px;border:2px solid #000}main>blockquote{padding:20px;border:2px solid #000}main>*{max-width:600px;margin-bottom:30px}header{padding:var(--main-padding);border-bottom:1px solid #363636}header h1{display:inline}footer{margin-top:auto;padding:var(--main-padding);clear:both}nav .site-nav ul li{list-style-type:none;display:flex;font-variant-numeric:tabular-nums;font-size:14px;padding-left:20px}li:has(input[type=checkbox]){display:block;list-style-type:none}ul:has(li input[type=checkbox]){padding:0}ul li a{overflow:hidden;text-overflow:ellipsis;width:calc(var(--nav-sidebar-width) + var(--nav-sidebar-offset));background-color:#fff}ul li a:hover{white-space:nowrap;width:100%;z-index:10}ul li p{margin-block-end:0;margin-block-start:0}time{padding-right:1rem}blockquote{margin:1em 0;padding:0 2em;border-left:3px solid #eee}img{max-width:100%}a,a:visited{color:#000}@media(prefers-color-scheme:dark){a,a:visited{color:#dadada}body{background:#1e1e1e;color:#dadada}body a{color:#dadada}pre{background:#fff;color:#1e1e1e}code{background:#fff;color:#1e1e1e}body select{color:#000;background-color:#fff}.project{border-left:2px solid #fff}.notice{border-color:#fff}.mono{filter:invert(1)}.progress>div{background-color:#fff}.progress>div>span{color:#000}main>blockquote{border-color:#fff}ul li a{background-color:inherit}section>ul li a{background-color:inherit}}@media(prefers-color-scheme:light){h1,h2,h3,h4{color:var(--primary-color-light)}}@media only screen and (max-width:1100px){:root{--nav-sidebar-width:140px;--nav-sidebar-offset:0px}nav{width:100%}nav .site-nav section{margin:0 10px 10px 0}nav.menu{max-width:100%;box-sizing:border-box;display:inline-block}nav .site-nav{display:grid;column-gap:var(--column-gap);grid-template-columns:repeat(auto-fill,minmax(var(--nav-sidebar-width),1fr))}main{display:inline-block;width:unset}main>*{max-width:100%}ul li a{width:var(--nav-sidebar-width)}}</style><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"playbook","name":"","headline":"","alternativeHeadline":"","description":"Source Version Control It\u0026rsquo;s like a time machine. We can save and reload anytime we want to, like in the old day of Game Boy Advance. We can work in parallel universes of our source code, experimenting without fear of losing work, and rolling back if something goes wrong.\nWe use git. Git is one of the most popular distributed source version control. We use Github to open source our works, playbook, and practices.","inLanguage":"en-us","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/note.d.foundation\/playbook\/engineering\/git\/"},"author":{"@type":"Person","name":"Han Ngo"},"creator":{"@type":"Person","name":"Han Ngo"},"accountablePerson":{"@type":"Person","name":"Han Ngo"},"copyrightHolder":"Dwarves Foundation","copyrightYear":"0001","date":"0001-01-01T00:00:00.00Z","dateCreated":"0001-01-01T00:00:00.00Z","datePublished":"0001-01-01T00:00:00.00Z","dateModified":"0001-01-01T00:00:00.00Z","publisher":{"@type":"Organization","name":"Dwarves Foundation","url":"https://note.d.foundation/","logo":{"@type":"ImageObject","url":"https:\/\/note.d.foundation\/","width":"32","height":"32"}},"image":"https://note.d.foundation/","url":"https:\/\/note.d.foundation\/playbook\/engineering\/git\/","wordCount":"1374","genre":[],"keywords":[]}</script><style>body{visibility:hidden;opacity:0}</style><noscript><style>body{visibility:visible;opacity:1}</style></noscript><script type=text/javascript>window.addEventListener("DOMContentLoaded",function(){document.body.style.visibility="visible",document.body.style.opacity=1})</script></head><body class=playbook><div class=grid><nav class=menu><h3>Dwarves Notes</h3><section class=site-nav><details><summary>home</summary><ul><li><a href=/guild/>Dwarves Guild</a></li><li><a href=/site-index/>Index</a></li></ul></details><details><summary>earn</summary><ul><li><a href=/earn/trend-command/>?trend command</a></li><li><a href=/earn/fleeting-notes/>A discord cmd to receive a link, and create a brainery fleeting note</a></li><li><a href=/earn/summary-article/>A discord cmd to summary article, using ChatGPT</a></li><li><a href=/earn/dwarvesf-map/>A webpage showing where the Dwarves from</a></li><li><a href=/earn/discord-publish-braniery/>Add new discord command to publish new brainery post</a></li><li><a href=/earn/brainery-metrics-report/>Brainery metrics report</a></li><li><a href=/earn/centralize-dwarves-calendar/>Centralize Dwarves Calendar</a></li><li><a href=/earn/chatbot-adversarial-prompt/>Chatbot: Adversarial prompts - politics, weapons, etc</a></li><li><a href=/earn/chatbot-llm-accuracy/>Chatbot: LLM accuracy with RLHF</a></li><li><a href=/earn/chatbot-memory/>Chatbot: memory (few shot)</a></li><li><a href=/earn/chatbot-prompt-size/>Chatbot: prompt size, context (zero shot)</a></li><li><a href=/earn/company-signature/>Company Signature</a></li><li><a href=/earn/company-social-graph/>Company Social Graph</a></li><li><a href=/earn/consulting-map/>Consulting record webpage</a></li><li><a href=/earn/layer-2-zk-rollup/>Design system for layer 2 using ZK rollup</a></li><li><a href=/earn/economic-calendar/>Economic calendar</a></li><li><a href=/earn/engagament-log/>Engagement Log</a></li><li><a href=/earn/feature-toggle/>Feature toggle</a></li><li><a href=/earn/financial-literacy-outline/>Financial Literacy outline: Phổ cập Kiến thức Tài chính</a></li><li><a href=/earn/fortress-shanky-data/>Fortress: API to show shanky data</a></li><li><a href=/earn/fortress-mma-score/>Fortress: MMA data</a></li><li><a href=/earn/hunger-game/>Hunger Game - Submit 2022</a></li><li><a href=/earn/integrate-rss-feed/>Integrate RSS feeds to chapter discord channels</a></li><li><a href=/earn/integrate-ts-reset/>Integrate ts-reset to nextjs boilerplate</a></li><li><a href=/earn/locale-web-mobile/>Locale on Web, Mobile</a></li><li><a href=/earn/monorepo-deployment-flow/>Monorepo deployment flow with Vercel</a></li><li><a href=/earn/enigma-checksum/>Open source Enigma checksum</a></li><li><a href=/earn/optimize-query-database/>Optimize Query Database 500M records, filter multiple tables</a></li><li><a href=/earn/project-changelog-tool/>Project Weekly Changelog Tooling</a></li><li><a href=/earn/react-server-component/>React Server Componen</a></li><li><a href=/earn/discord-role/>Rework Discord Role</a></li><li><a href=/earn/dwarves-email-domain/>Rework Dwarves Email Domain</a></li><li><a href=/earn/tech-radar-report/>Tech radar status report</a></li><li><a href=/earn/treasure-hunt/>Treasure Hunt - Submit 2022</a></li><li><a href=/earn/upgraed-nextjs-boilerplate/>Upgrade nextjs-boilerplate to Nextjs 13</a></li><li><a href=/earn/zod-nextjs-boilerplate/>Use Zod to validate schema in nextjs-boilerplate</a></li><li><a href=/earn/type-safe-framework/>wagmi website, fork xkcd, with crm for img uploading</a></li></ul></details><details><summary>hiring</summary><ul><li><a href=/hiring/additional-info/benefits-and-perks/>benefits-and-perks</a></li><li><a href=/hiring/additional-info/how-we-hire/>how-we-hire</a></li><li><a href=/hiring/additional-info/how-we-work/>how-we-work</a></li><li><a href=/hiring/additional-info/making-a-career/>making-a-career</a></li><li><a href=/hiring/additional-info/what-we-stand-for/>what-we-stand-for</a></li><li><a href=/hiring/additional-info/what-we-value/>what-we-value</a></li><li><a href=/hiring/additional-info/where-we-work/>where-we-work</a></li></ul></details><details><summary>memo</summary><ul></ul></details></section></nav><main><h1 id=source-version-control><a href=#source-version-control>Source Version Control <a href=#source-version-control></a></a></h1><p>It&rsquo;s like a time machine. We can save and reload anytime we want to, like in the old day of Game Boy Advance. We can work in parallel universes of our source code, experimenting without fear of losing work, and rolling back if something goes wrong.</p><p><a href=https://egghead.io/courses/how-to-contribute-to-an-open-source-project-on-github>We use git</a>. Git is one of the most popular distributed source version control. We use <a href=github.com/dwarvesf/>Github</a> to open source our works, playbook, and practices. We also have a <a href=git.d.foundation>self-host Gitlab</a> to store all of our source code.</p><h2 id=commit-message-guidelines><a href=#commit-message-guidelines>Commit Message Guidelines <a href=#commit-message-guidelines></a></a></h2><p>Hour commit conventions are based on <a href=https://www.conventionalcommits.org/en/v1.0.0/#specification>Conventional Commits</a></p><p>Commit message should be structured as follows</p><pre><code># A - inline command
git commit -m &quot;&lt;type&gt;(optional scope): &lt;commit message&gt;&quot;

# B - in a commit editor
&lt;type&gt;(optional scope): &lt;description&gt;

[optional body]

[optional footer(s)]
</code></pre><p><strong>Types:</strong></p><p>Must be one of the following:</p><ul><li>build: Changes that affect the build system or external dependencies</li><li>ci: Changes to our CI configuration files and scripts (example scopes: Github Action, Travis, Circle, Jenkins)</li><li>docs: Documentation only changes</li><li>feat: A new feature</li><li>fix: A bug fix</li><li>perf: A code change that improves performance</li><li>refactor: A code change that neither fixes a bug nor adds a feature</li><li>style: Changes that do not affect the meaning of the code (white-space, formatting, missing semi-colons, etc)</li><li>test: Adding missing tests or correcting existing tests</li><li>revert: Indicate that we revert a previous commit, followed by the header of the reverted commit. In the body, it should say: This reverts commit <hash>., where the hash is the SHA of the commit being reverted.</li></ul><p><strong>Scope</strong></p><p>The scope is optional and it should be the name of the package or module in your app/monorepo</p><p>Example: marketplace, ui, libs, utils, crawler, api</p><p><strong><code>Type</code> and <code>Versioning</code></strong></p><p>We follow <a href=/playbook/engineering/versioning/>SenVer</a> to release our app/package.</p><ul><li>feat, fix, refactor anything cause breaking change → bump <code>MAJOR</code> version</li><li>feat, perf → bump <code>MINOR</code> version</li><li>fix, refactor → bump <code>PATCH</code></li><li>chore, refactor, test, style, docs, ci, build → no version bump</li></ul><p><strong>Toolings</strong>
We use automation tools that are useful to force and check commit message convection</p><ul><li><a href=https://github.com/changesets/changesets>changeset</a> - manage your versioning and changelogs</li><li><a href=https://github.com/semantic-release/github>semantic release</a> - plugin to publish a GitHub release and comment on released Pull Requests/Issues</li><li><a href=https://github.com/conventional-changelog/commitlint>commitlint</a> - lint your commit message</li><li><a href=https://github.com/marketplace/actions/commit-linter>commitlint Github Action</a> - check your commit with Github Action</li><li>commit hooks:<ul><li>create your own with bash script</li><li>nodejs tool: husky and lint-staged</li></ul></li></ul><h2 id=branching><a href=#branching>Branching <a href=#branching></a></a></h2><p><strong>Naming convention</strong></p><p>Same as commit convention we shared type for branching prefix
The new branch name should be structured as follows</p><pre><code class=language-bash>git checkout -b &lt;type&gt;/your-branch-name

# example
git checkout -b feat/marketplace-home-page
git branch docs/add-how-to-use-git
</code></pre><p><strong>Preserved Names</strong></p><ul><li>master/main - the base branch, can be used as production branch</li><li>develop - the development branch, base branch for feature, fix, chore&mldr;</li><li>release/production, stag/qa/qc - optional branches for your other deployment environments</li></ul><p><strong>Branching strategy</strong></p><p>There is only one eternal branch – you can call it master, develop, current, next – whatever. We prefer to use <strong>“master”</strong></p><p>All other branches (feature, release, fix, and whatever else you need) are temporary and only used as a convenience to share code with other developers and as a backup measure. They are always removed once the changes present in them land on master.</p><ul><li>Github flow<ul><li>Create a new branch from the base branch (normally is develop or master/main)</li><li>Make changes and add commits</li><li>Open a Pull Request</li><li>Review</li><li>Deploy (optional) - branch deployment</li><li>Merge</li><li>Delete your branch</li></ul></li></ul><p><strong>How to collaborate/contribute to open source repo</strong></p><ul><li>To be able to contribute to an open source repo you first have to <code>fork</code> the repo to your account</li><li>Clone your forked repo <code>git clone forked-git-repo</code></li><li>Adding new remote using <code>git remote add upstream original-git-repo</code><ul><li>Please note that we now have 2 remotes to work with<ul><li>the <code>origin</code> alias is pointing to the forked repo which you have full permission to create/delete branches</li></ul></li><li>the <code>upstream</code> alias is pointing to the original repo that you forked from which you have limited permission</li></ul></li><li>Create a new branch and make changes to your local repo</li><li>Commit and push your work to <code>forked repo</code> <code>git push origin your-work</code></li><li>Go to github original repo to create a new PR with the target branch is you created from the forked repo</li><li>To update the base branch synced with the original repo using</li></ul><pre><code class=language-bash># base branch is `master`
git checkout master
git fetch upstream

# O1. pull and merge
git pull upstream/master


# O2. rebase
git rebase upstream/master

# 03. reset
git reset --hard upstream/master


# after the local base branch is updated push to origin to update your forked repo
git push origin master
</code></pre><h2 id=practices><a href=#practices>Practices <a href=#practices></a></a></h2><ul><li><strong>Amend commit</strong>: edit the latest commit</li></ul><blockquote><p><code>git commit --amend</code> will allow you to change the last commit message or add new files to it</p><p>Notice: the commit sha will be changed after you alter the commit</p></blockquote><p>Example</p><pre><code class=language-bash># The current tree: git log --oneline --decorate --graph
# * c format qa defect template (#49)
# * b rename /Testing to /qa
# * a add documents for QA (#47)

# You wanted to update the last commit message
git commit --amend

# The tree changed
# The current tree: git log --oneline --decorate --graph
# * d update git practice with commit sha changed
# * b rename /Testing to /qa
# * a add documents for QA (#47)
</code></pre><ul><li><strong>Merge</strong></li></ul><blockquote><p>The <code>git merge</code> command lets you take the independent lines of development created by <code>git branch</code> and integrate them into a single branch.</p><p>Ref: <a href=https://www.atlassian.com/git/tutorials/using-branches/git-merge>https://www.atlassian.com/git/tutorials/using-branches/git-merge</a></p></blockquote><p><img src="https://wac-cdn.atlassian.com/dam/jcr:c6db91c1-1343-4d45-8c93-bdba910b9506/02%20Branch-1%20kopiera.png?cdnVersion=487" alt="git merge" onerror="this.onerror=null"></p><p>Usage</p><pre><code class=language-bash># you're your feature branch
# fetch for updates
git fetch

# sample 1
git merge origin/master # to update with master on the origin
# sample 2
git merge feat/feature-2 # merge feature-2 into the current branch
</code></pre><ul><li><strong>Rebase</strong></li></ul><blockquote><p>Rebasing is the process of moving or combining a sequence of commits to a new base commit</p><p>Ref: <a href=https://www.atlassian.com/git/tutorials/rewriting-history/git-rebase>https://www.atlassian.com/git/tutorials/rewriting-history/git-rebase</a></p></blockquote><p><img src="https://wac-cdn.atlassian.com/dam/jcr:4e576671-1b7f-43db-afb5-cf8db8df8e4a/01%20What%20is%20git%20rebase.svg?cdnVersion=487" alt="git merge" onerror="this.onerror=null"></p><p>Usage</p><pre><code class=language-bash># you're your feature branch
# fetch for updates
git fetch
# brings all of your commits to the head of the master branch
git rebase origin/master

</code></pre><ul><li><p><strong>Advanced rebase: rebase interactive</strong></p><blockquote><p>With <code>git rebase -i [base-branch or commit-id]</code> allows you to changing older or multiple commits
You can:</p><ul><li>reorder by changing the order of the commit list in the rebase interactive editor</li><li>update older commits: Commit marked with <code>rework | r</code> will allow you to modify that commit</li><li>drop commit. Commits marked with <code>drop | d</code> will be dropped from history when rebasing</li><li>squash/fix. Commits marked with <code>squash | s</code> or <code>fix | f</code> will be merged into previous commits</li></ul></blockquote></li><li><p><strong>Cherry pick</strong></p></li></ul><blockquote><p><code>git cherry-pick commitSha</code> is a powerful command that enables arbitrary Git commits to be picked by reference and appended to the current working HEAD. Cherry picking is the act of picking a commit from a branch and applying it to another.</p></blockquote><p>Example</p><pre><code class=language-bash># Current tree
# a - b - c - d   Main
#      \
#        e - f - g Feature
#
# You want to pick the commit `f` and bring it to master
git cherry-pick f

# Result tree
# a - b - c - d   Main
#      \
#        e - f - g Feature
</code></pre><ul><li><strong>Reflog:</strong></li></ul><blockquote><p><code>git reflog</code> is the safety net that allows you to go back to commits even though they are not referenced by any branch or tag. After rewriting history, the reflog contains information about the old state of branches and allows you to go back to that state if necessary</p><p>Ref: <a href=https://www.atlassian.com/git/tutorials/rewriting-history/git-reflog>https://www.atlassian.com/git/tutorials/rewriting-history/git-reflog</a></p></blockquote><p>Example</p><pre><code class=language-bash># Scenario: you found out that you should not amend the latest commit and
# you wanted to reset to the commit before you amend
# get ref logs
git reflog show head
# Out put
# b675a11 head@{0}: commit (amend): fix layout
# 8c76ad1 head@{1}: commit (amend): fix something
# 873abad head@{2}: rebase (continue) (finish): returning to refs/heads/branch-name
# 873abad head@{3}: rebase (continue): meaningful commit message

git reset --hard 8c76ad1
</code></pre><ul><li><strong>Remote Reflog:</strong></li></ul><blockquote><p>Same as reflog this will help you recovering a commit from Github’s Reflog</p><p>Ref: the <a href=https://objectpartners.com/2014/02/11/recovering-a-commit-from-githubs-reflog/>original blog</a></p></blockquote><ul><li>Retrieve the commit SHA</li></ul><pre><code class=language-bash>$ curl https://api.github.com/repos/{owner}/{repo}/events
</code></pre><ul><li>You can find the commit you lost in the repo event response. Use the commit SHA and github refs API to create new branch from that commit</li></ul><pre><code class=language-bash>$ curl -i \
  -X POST \
  -H &quot;Accept: application/json&quot; \
  -H &quot;Content-Type: application/json&quot; \
  -d '{&quot;ref&quot;:&quot;refs/heads/D-commit&quot;, &quot;sha&quot;:&quot;your-commit-sha&quot;}' \
  https://api.github.com/repos/{owner}/{repo}/git/refs
</code></pre></main></div></body></html>