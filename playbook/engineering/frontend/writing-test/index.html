<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content><meta name=keywords content><meta name=title content><meta name=description content><meta property="og:title" content><meta property="og:description" content><meta property="og:type" content="article"><meta property="og:url" content="https://note.d.foundation/playbook/engineering/frontend/writing-test/"><meta property="og:image" content="https://note.d.foundation/img/LOGO.png"><meta property="twitter:title" content><meta property="twitter:description" content><meta property="twitter:type" content="article"><meta property="twitter:url" content="https://note.d.foundation/playbook/engineering/frontend/writing-test/"><meta property="twitter:image" content="https://note.d.foundation/img/LOGO.png"><link rel=icon type=image/x-icon href=https://note.d.foundation/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://note.d.foundation/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://note.d.foundation/favicon-32x32.png><link rel=apple-touch-icon href=https://note.d.foundation/apple-touch-icon.png><title></title>
<link rel=canonical href=https://note.d.foundation/playbook/engineering/frontend/writing-test/><link rel="shortcut icon" type=image/png href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNk+A8AAQUBAScY42YAAAAASUVORK5CYII="><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vs.min.css integrity="sha512-Jn4HzkCnzA7Bc+lbSQHAMeen0EhSTy71o9yJbXZtQx9VvozKVBV/2zfR3VyuDFIxGvHgbOMMNvb80l+jxFBC1Q==" crossorigin=anonymous referrerpolicy=no-referrer media="(prefers-color-scheme: dark)"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vsc-dark-plus.min.css integrity="sha512-ML8rkwYTFNcblPFx+VLgFIT2boa6f8DDP6p6go4+FT0/mJ8DCbCgi6S0UdjtzB3hKCr1zhU+YVB0AHhIloZP8Q==" crossorigin=anonymous referrerpolicy=no-referrer media="(prefers-color-scheme: light)"><script defer data-domain=note.d.foundation src=https://plausible.io/js/script.js></script><script defer src=https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js></script><link rel=preconnect href=https://B0BWKXLVM9-dsn.algolia.net crossorigin><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@docsearch/css@3><script src=https://cdn.jsdelivr.net/npm/@docsearch/js@3></script><style>body{font-family:ibm plex sans,sans-serif;font-size:1rem;color:#000;text-rendering:optimizeLegibility;padding:2rem;max-width:100%;margin:0;padding:0;background-color:var(--primary-background-color-light);line-height:1.5;min-height:100vh;display:flex;flex-direction:column;hyphens:auto}h1,h2,h3,h4{color:var(--primary-font-color);line-height:1.24}h1{font-size:32pt}h2{font-size:24pt}h3{font-size:16pt}h4{font-size:12pt}a[href^="#"]{text-decoration:none}time{padding-right:1rem}blockquote{margin:1em 0;padding:0 2em;border-left:3px solid #eee}img{max-width:100%}video{max-width:100%}a,a:visited{color:#000}q{font-size:20px;max-width:500px;display:block;margin-left:30px}pre{font-family:monospace!important;background:#000!important;color:#dadada;padding:4px!important;margin:0!important;border-radius:2px;overflow-x:auto;width:100%;max-width:100vw!important;box-sizing:border-box;background-clip:padding-box}pre>code{text-indent:0;white-space:inherit;font-weight:400;padding:15px!important;box-sizing:border-box;background-clip:padding-box}code{line-height:1.5!important;font-family:monospace!important;font-size:12px!important;background:#333!important;color:#dadada;padding:2px 5px;white-space:wrap;border-radius:2px;font-weight:700;display:inline-block;margin-bottom:-4px;box-sizing:border-box;background-clip:padding-box}code comment{color:#777}table code{margin:0;background:var(--secondary-background-color-light)!important;color:var(--secondary-font-color-light);border:.5px solid var(--secondary-font-color-light)}span a,span a:visited{color:inherit}[style*="color:yellow"]{color:gold!important}[style*="color:blue"]{color:#6495ed!important}[style*="color:red"]{color:crimson!important}@media(prefers-color-scheme:dark){a,a:visited{color:#dadada}pre{font-family:monospace!important;background:#fff!important;color:var(--primary-background-color)}code{font-family:monospace!important;background:#ddd!important;color:var(--primary-background-color)}table code{background:var(--secondary-background-color)!important;color:var(--secondary-font-color)}}iframe{box-sizing:border-box;max-width:100%}@media(prefers-color-scheme:light){h1,h2,h3,h4{color:var(--primary-font-color-light)}}@media screen and (max-width:1100px){h1{font-size:calc(1.45rem + 2vw)}h2{font-size:calc(1rem + 1.5vw)}h3{font-size:calc(1rem + 1vw)}h4{font-size:calc(1rem + .5vw)}}:root{--primary-color:#e13F5e;--docsearch-primary-color:#e13F5e;--docsearch-primary-color:#e13F5e;--primary-font-color:#ddd;--primary-font-color-light:#333;--secondary-font-color:#e8e8e8;--secondary-font-color-light:#717171;--primary-background-color:#1e1e1e;--primary-background-color-light:#fff;--secondary-background-color:#282828;--secondary-background-color-light:#f6f6f6;--border-color:#3d3d3d;--border-color-light:#e7e7e7;--container-max-width:1240px;--main-padding:36px;--column-gap:24px;--nav-sidebar-width:200px;--nav-sidebar-offset:0px}.grid .title{grid-area:title;margin:32px 0 0!important;color:var(--primary-color)}.grid .subtitle{grid-area:subtitle;font-size:18px;padding-top:16px;padding-bottom:32px}.grid #docsearch{grid-area:docsearch}.grid #docsearch>button{width:90%;height:75%;border-radius:0}.grid #docsearch>button>span{padding-left:12px;font-family:ibm plex sans,sans-serif}.DocSearch-Footer{box-shadow:none}.active{color:var(--primary-color);line-height:1;border-bottom:2px solid var(--primary-color);padding-top:4px!important}nav.tab-menu{grid-area:tabmenu;border-bottom:1px solid var(--border-color-light);padding-bottom:0;overflow:auto}nav.tab-menu ul{list-style-type:none;padding:0;margin-bottom:0;display:inline-grid;grid-auto-flow:column;grid-template-rows:1fr;grid-template-columns:repeat(auto-fit,minmax(min-content,1fr));column-gap:48px}nav.tab-menu ul li{font-size:16px;font-weight:500;display:inline-block;padding:0 0 16px;width:min-content}nav.tab-menu ul li a{text-decoration:none;color:inherit}nav.tab-menu ul li a:hover{background-color:var(--primary-background-color);padding:0}nav.tab-menu ul li:last-of-type{margin-right:30px!important}@media(prefers-color-scheme:dark){nav.tab-menu{border-bottom:1px solid var(--border-color)}}@media only screen and (max-width:1100px){.DocSearch{width:100%!important;height:50px!important;padding:0;margin:0}}nav.menu{padding:calc(var(--main-padding) - 12px)var(--main-padding);line-height:22px;white-space:nowrap;grid-area:nav}details{margin-left:-7px;overflow:hidden;font-size:14px}summary{display:block;padding:5px 5px 12px 20px;position:relative;cursor:pointer;font-size:20px;font-weight:600;text-transform:capitalize;user-select:none}nav section details:not(:last-of-type) ul{margin-bottom:24px}summary:before{content:'\25B8';position:absolute;top:7px;left:0;transform:rotate(0);transform-origin:50% 50%;transition:.25s transform ease;font-size:16px;height:16px;width:16px;font-weight:200;display:flex;justify-content:center;align-items:center}summary:before>*{height:4px;width:4px}details[open]>summary:before{transform:rotate(90deg)}details summary::-webkit-details-marker{display:none}details>ul{margin-bottom:0}hr{margin:20px 0!important;width:100%;max-width:inherit;border-color:var(--secondary-background-color-light)}nav.menu{background-color:var(--secondary-background-color-light)}nav .site-nav{display:inline-block;width:100%}nav .site-nav section{margin-top:-2px}nav .site-nav section h2{margin:20px 0;font-size:24px;text-transform:lowercase}nav.menu ul{display:inline-grid;grid-template-rows:repeat(auto-fill,minmax(0,1fr));grid-template-columns:repeat(auto-fill,minmax(var(--nav-sidebar-width),1fr));padding:0 10px 10px 0;margin:0;list-style-type:none;line-height:22px;box-sizing:border-box}nav .site-nav ul li{list-style-type:none;display:flex;font-variant-numeric:tabular-nums;font-size:14px;padding-left:20px;max-width:fit-content}nav .site-nav ul li a{padding:0 4px}.load-more{font-style:italic;padding-top:8px;color:var(--primary-color)!important;cursor:pointer}@media(prefers-color-scheme:dark){nav.menu{background-color:var(--secondary-background-color)}hr{border-color:var(--secondary-background-color)}}@media only screen and (max-width:1100px){nav.menu{padding:4.5%}nav.menu ul{width:100%;row-gap:4px;column-gap:4px}nav .site-nav section{margin:0 10px 10px 0}nav.menu{max-width:100%;box-sizing:border-box;display:inline-block}}footer{padding:var(--main-padding);clear:both;border-top:1px solid var(--border-color-light)}footer span{color:var(--secondary-font-color-light)}@media(prefers-color-scheme:dark){footer{border-top:1px solid var(--border-color)}footer span{color:var(--secondary-font-color)}}.note-title{display:inline-grid;width:100%;row-gap:12px;margin:0;grid-template-areas:"pagetitle pagetitle" "date tags" "authors tags";grid-template-rows:repeat(auto-fill,minmax(0,1fr));grid-template-columns:repeat(2,1fr)}.note-title .pagetitle{grid-area:pagetitle;margin:0}.note-title .date{grid-area:date;color:#636466}.note-title .tags{display:inline-flex;flex-wrap:wrap;gap:6px;grid-area:tags;justify-self:right;justify-content:right}.note-title .tags .tag{padding:1px 6px;border-radius:4px;background-color:var(--secondary-background-color-light);height:fit-content;text-decoration:none;color:var(--secondary-font-color-light)}.note-title .authors{grid-area:authors}.clear-title{grid-template-areas:"pagetitle pagetitle";gap:0}.clear-title .date{display:none}.clear-title .tags{display:none}.clear-title .authors{display:none}code.button{background:var(--primary-background-color-light);color:#000;font-size:smaller;display:inline-block;padding:0 6px;font-weight:700;border-radius:2px;line-height:22px}.grid{display:inline-grid;grid-template-areas:"title title title title" "subtitle subtitle docsearch docsearch" "tabmenu tabmenu tabmenu tabmenu" "nav content content pagenav" "nav content content pagenav";grid-template-rows:repeat(auto-fill,minmax(0,1fr));grid-template-columns:325px 2fr 2fr 1fr;column-gap:var(--column-gap)}.grid>*{padding-right:calc(var(--main-padding) - 12px);padding-left:calc(var(--main-padding) + 12px)}#docsearch{grid-area:docsearch}main{grid-area:content;display:inline-block;padding:var(--main-padding);width:calc(100vw - 325px - 72px);max-width:var(--container-max-width);box-sizing:border-box;overflow-wrap:break-word;hyphens:none;justify-self:left}main ul{line-height:25px;margin:0;padding:0;padding-inline-start:40px}main ul>li>a{text-decoration:underline}.scrollable{overflow:auto}.dual-list>ul{columns:2}.single-list>ul{columns:2}.profile img{width:100px;height:100px;object-fit:cover;aspect-ratio:1/1}.profile object{width:100px;height:100px;object-fit:cover;aspect-ratio:1/1}table,th,td{border:1px solid;border-collapse:collapse;border-spacing:0;border-color:var(--border-color-light)}thead *{padding:6px 12px;background-color:var(--secondary-background-color-light)}th,td{padding:6px 12px;overflow:hidden;text-overflow:ellipsis;vertical-align:top;text-align:left}td:has(img){padding:12px;line-height:0}table{table-layout:fixed}table:has(th:empty){border:none}table:has(th:empty) th{border:none;padding:0;line-height:0}table:has(th:empty) td{border:none}table:has(img){width:100%;height:100%}table:has(img) td{min-width:200px}table:has(img) img{width:100%!important;height:100%!important;object-fit:cover}#TableOfContents>ul>li>a{text-decoration:underline}#TableOfContents>ul{display:grid;column-gap:var(--column-gap);box-sizing:border-box;grid-template-columns:repeat(auto-fill,minmax(0,calc(50% - var(--column-gap))));line-height:20px}#TableOfContents li{white-space:nowrap;list-style-type:decimal-leading-zero;list-style-position:inside;overflow:hidden;text-overflow:ellipsis}.notice{padding:20px;border:2px solid #000;margin-bottom:16px}main>blockquote{padding:20px;border:2px solid #000}main>*{max-width:inherit}li:has(input[type=checkbox]){display:block;list-style-type:none}ul:has(li input[type=checkbox]){padding:0}ul li a{overflow:hidden;text-overflow:ellipsis;white-space:wrap;text-decoration:none;transition:all .25s ease}ul li a:hover{background-color:var(--primary-color);color:#fff;padding-left:4px;padding-right:4px;border-radius:4px;width:100%;z-index:10}ul li p{margin-block-end:0;margin-block-start:0}@media(prefers-color-scheme:dark){html[data-theme=dark]{--docsearch-searchbox-background:var(--secondary-background-color);--docsearch-modal-background:var(--secondary-background-color);--docsearch-footer-background:var(--secondary-background-color);--docsearch-key-gradient:linear-gradient(-26.5deg, #555, var(--secondary-background-color));--docsearch-muted-color:#777;--docsearch-key-shadow:inset 0 -2px 0 0 var(--secondary-background-color),inset 0 0 1px 1px #555,0 2px 2px 0 rgba(3,4,9,0.3)}body{background:var(--primary-background-color);color:#dadada}body select{color:#000;background-color:#fff}.project{border-left:2px solid #fff}.notice{border-color:#fff}.mono{filter:invert(1)}.progress>div{background-color:#fff}.progress>div>span{color:#000}main>blockquote{border-color:#fff}ul li a{background-color:inherit}section>ul li a{background-color:inherit}.note-title .tags .tag{background-color:var(--secondary-background-color);color:var(--secondary-font-color)}table,th,td{border-color:var(--border-color)}thead *{background-color:var(--secondary-background-color)}}@media only screen and (max-width:1100px){.grid{display:inline-grid;grid-template-areas:"title" "subtitle" "docsearch" "tabmenu" "content" "nav" "pagenav";grid-template-rows:repeat(auto-fill,minmax(0,1fr));grid-template-columns:1fr}.grid>*{padding-right:4.5%;padding-left:4.5%}.note-title{width:100%;grid-template-areas:"pagetitle" "date" "tags" "authors";grid-template-rows:repeat(auto-fill,minmax(0,1fr));grid-template-columns:1fr}.note-title .tags{max-width:max-content;justify-self:left;justify-content:flex-start}main{justify-self:center;width:100%;max-width:700px}}.col-2{display:inline-grid;column-gap:36px;padding-bottom:36px;grid-template-columns:repeat(auto-fit,minmax(20%,1fr))}.col-2>*{overflow-wrap:break-word;overflow:auto}</style><script defer src=/js/process-comments.js></script><script defer src=/js/tab-menu.js></script><script defer src=/js/markdown-entities.js></script><script defer src=/js/algolia.js></script><script defer src=/js/dark-light-check.js></script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"playbook","name":"","headline":"","alternativeHeadline":"","description":"Writing test Testing your application is a vital part of serious development. For the front-end, you don\u0026rsquo;t need 100% code coverage, about 70% is probably good enough. Following are some principles:\nWrite tests. Not too many. Mostly integration. Tests should make you more productive not slow you down. Maintaining tests can slow you down. You get dimishing returns on adding more tests after a certain point. Your tests should always resemble the way your software is used.","inLanguage":"en-us","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/note.d.foundation\/playbook\/engineering\/frontend\/writing-test\/"},"author":{"@type":"Person","name":"Han Ngo"},"creator":{"@type":"Person","name":"Han Ngo"},"accountablePerson":{"@type":"Person","name":"Han Ngo"},"copyrightHolder":"Dwarves Foundation","copyrightYear":"0001","date":"0001-01-01T00:00:00.00Z","dateCreated":"0001-01-01T00:00:00.00Z","datePublished":"0001-01-01T00:00:00.00Z","dateModified":"0001-01-01T00:00:00.00Z","publisher":{"@type":"Organization","name":"Dwarves Foundation","url":"https://note.d.foundation/","logo":{"@type":"ImageObject","url":"https:\/\/note.d.foundation\/","width":"32","height":"32"}},"image":"https://note.d.foundation/","url":"https:\/\/note.d.foundation\/playbook\/engineering\/frontend\/writing-test\/","wordCount":"1544","genre":[],"keywords":[]}</script><style>body{visibility:hidden;opacity:0}</style><noscript><style>body{visibility:visible;opacity:1}</style></noscript><script type=text/javascript>window.addEventListener("DOMContentLoaded",function(){document.body.style.visibility="visible",document.body.style.opacity=1})</script></head><body><div class=grid><h1 class=title><a style=color:inherit;text-decoration:none href=/site-index>Dwarves Notes</a></h1><div class=subtitle>A collection of notes for everything we do and operate at Dwarves.</div><div id=docsearch></div><nav class=tab-menu x-data="{
    currentUrl: `/playbook/engineering/frontend/writing-test/`,
    links: [
      { title: 'Home', url: '/home/' },
      { title: 'Consulting', url: '/memo/consulting/' },
      { title: 'Labs', url: '/memo/labs' },
      { title: 'Earn', url: '/earn/' },
      { title: 'Hiring', url: '/hiring/' },
      { title: 'Newsletter', url: '/newsletter/' },
      { title: 'Events', url: '/events/' },
    ],
    activeUrl: '',
    isActiveUrl(url) {
      if (!this.activeUrl) {
        this.activeUrl = this.currentUrl.startsWith(url);
        return this.activeUrl;
      }
    },
  }"><ul><template x-for="item in links"><li x-bind:class="{ 'active': isActiveUrl(item.url) }"><a x-bind:href=item.url x-text=item.title></a></li></template></ul></nav><nav class=menu><section class=site-nav x-data="{
      currentUrl: `/playbook/engineering/frontend/writing-test/`,
      get data() {
        const dataString = `[]`;
        const data = JSON.parse(dataString);
        data.sort((a, b) => Date.parse(b.date) - Date.parse(a.date));
        console.log(data);
        return data;
      },
    }"><details open><summary>Pinned Notes</summary><ul><template x-for="item in data" x-bind:key=item><li><a x-bind:href=item.url x-text=item.title></a></li></template></ul></details></section></nav><main x-data="{
      currentUrl: `/playbook/engineering/frontend/writing-test/`,
      title: ``,
      get tagsData() {
        const dataString = `[{&#34;tags&#34;:null,&#34;url&#34;:&#34;/playbook/engineering/frontend/writing-test/&#34;}]`;
        const data = JSON.parse(dataString);
        return data;
      },
      isClearPage() {
        const showFrontmatter = (/true/i).test(``);
        return !showFrontmatter || this.currentUrl.includes('home') || this.currentUrl.includes('tags');
      },
      isTagPage() {
        return this.currentUrl.includes('tags');
      }
    }"><template x-if=!!title><div x-bind:class="{ 'note-title': true, 'clear-title': isClearPage() }"><div class=title-index style=display:none></div><div class=tags-index style=display:none>tags:</div><template x-if=isTagPage()><h1 class=pagetitle x-text="`#${title}`"></h1></template><template x-if=!isTagPage()><h1 class=pagetitle x-text=title></h1></template><div class=date>Jan 1, 0001</div><template x-for="data in tagsData"><template x-if="data.tags && data.tags.length > 0"><div class=tags>Tags:
<template x-for="tag in data.tags"><a class=tag x-bind:href="`/tags/${tag.toLowerCase()}`" x-text=tag></a></template></div></template></template></div><hr></template><h1 id=writing-test><a href=#writing-test>Writing test <a href=#writing-test></a></a></h1><p>Testing your application is a vital part of serious development. For the front-end, you don&rsquo;t need 100% code coverage, about 70% is probably good enough. Following are some principles:</p><ul><li><em>Write tests. Not too many. Mostly integration</em>.</li><li>Tests should make you more productive not slow you down. Maintaining tests can slow you down. You get dimishing returns on adding more tests after a certain point.</li><li>Your tests should always resemble the way your software is used.</li><li>Make sure that you&rsquo;re not testing implementation details - things which users do not use, see, or even know about.</li><li>If your tests don&rsquo;t make you confident that you didn&rsquo;t break anything, then they didn&rsquo;t do their (one and only) job.</li><li>You&rsquo;ll know you implemented correct tests when you rarely have to change tests when you refactor code given the same user behavior.</li><li>Use <a href=https://jestjs.io/>Jest</a>, <a href=https://testing-library.com/docs/react-testing-library/intro/>React testing library</a>, <a href=https://www.cypress.io/>Cypress</a>, and <a href=https://github.com/mswjs/msw>Mock service worker</a>.</li></ul><h2 id=unit-testing><a href=#unit-testing>Unit testing <a href=#unit-testing></a></a></h2><p>Unit testing is the practice of testing the smallest possible units of our code, functions. We run our tests and automatically verify that our functions do the thing we expect them to do. We assert that, given a set of inputs, our functions return the proper values and handle problems.</p><p>We use the Jest test framework to run tests and make assertions. This library makes writing tests as easy as speaking - you describe a unit of your code and expect it to do the correct thing.</p><p>For the sake of this guide, lets pretend we&rsquo;re testing this function. It&rsquo;s situated in the <code>number.ts</code> file:</p><pre><code class=language-js>export function add(x: number, y: number) {
  return x + y;
}
</code></pre><p>First create a folder call <code>tests</code> then add a second <code>add.test.ts</code> file with our unit test inside.</p><pre><code class=language-js>import { add } from '../number.ts';

describe('add()', () =&gt; {
  it('adds two numbers', () =&gt; {
    expect(add(2, 3)).toEqual(5);
  });

  it(&quot;doesn't add the third number&quot;, () =&gt; {
    expect(add(2, 3, 5)).toEqual(add(2, 3));
  });
});
</code></pre><p>Should our function work, Jest will show this output when running the tests:</p><pre><code class=language-bash>add()
  ✓ adds two numbers
  ✓ doesn't add the third number
</code></pre><p>Oh no, now our function doesn&rsquo;t add the numbers anymore, it multiplies them! Imagine the consequences to our code that uses the function!</p><p>Thankfully, we have unit tests in place. Because we run the unit tests before we deploy our application, we see this output:</p><pre><code>● add() › adds two numbers

  expect(received).toEqual(expected)

  Expected value to equal:
    5
  Received:
    6

add()
  ✕ adds two numbers
  ✓ doesn't add the third number
</code></pre><h2 id=component-testing><a href=#component-testing>Component testing <a href=#component-testing></a></a></h2><p>Unit testing your utils and hooks is nice, but you can do even more to make sure nothing breaks your application. Since React is the view layer of your app, let&rsquo;s see how to test Components too!</p><h3 id=shallow-rendering><a href=#shallow-rendering>Shallow rendering <a href=#shallow-rendering></a></a></h3><p>React provides us with a nice add-on called the Shallow Renderer. This renderer will render a React component <strong>one level deep</strong>. Lets take a look at what that means with a simple <code>&lt;Button></code> component.</p><p>This component renders a <code>&lt;button></code> element containing a checkmark icon and some text:</p><pre><code class=language-javascript>import React from 'react';
import CheckmarkIcon from './CheckmarkIcon';

function Button(props) {
  return (
    &lt;button className=&quot;btn&quot; onClick={props.onClick}&gt;
      &lt;CheckmarkIcon /&gt;
      {React.Children.only(props.children)}
    &lt;/button&gt;
  );
}

export default Button;
</code></pre><p>It might be used in another component like this:</p><pre><code class=language-javascript>import Button from './Button';

function HomePage() {
  return &lt;Button onClick={this.doSomething}&gt;Click me!&lt;/Button&gt;;
}
</code></pre><p>When rendered normally with the standard <code>ReactDOM.render</code> function, this will be the HTML output (<em>Comments added in parallel to compare structures in HTML from JSX source</em>):</p><pre><code class=language-html>&lt;button&gt;
  &lt;!-- &lt;Button&gt;             --&gt;
  &lt;i class=&quot;fa fa-checkmark&quot;&gt;&lt;/i&gt;
  &lt;!--   &lt;CheckmarkIcon /&gt;  --&gt;
  Click Me!
  &lt;!--   { props.children } --&gt;
&lt;/button&gt;
&lt;!-- &lt;/Button&gt;            --&gt;
</code></pre><p>Conversely, when rendered with the shallow renderer, we&rsquo;ll get a String containing this &ldquo;HTML&rdquo;:</p><pre><code class=language-html>&lt;button&gt;
  &lt;!-- &lt;Button&gt;             --&gt;
  &lt;CheckmarkIcon /&gt;
  &lt;!--   NOT RENDERED!      --&gt;
  Click Me!
  &lt;!--   { props.children } --&gt;
&lt;/button&gt;
&lt;!-- &lt;/Button&gt;            --&gt;
</code></pre><p>If we test our <code>Button</code> with the normal renderer and there&rsquo;s a problem with the <code>CheckmarkIcon</code> then the test for the <code>Button</code> will fail as well. This makes it harder to find the culprit. Using the <em>shallow</em> renderer, we isolate the problem&rsquo;s cause since we don&rsquo;t render any other components other than the one we&rsquo;re testing!</p><p>The problem with the shallow renderer is that all assertions have to be done manually, and you cannot do anything that needs the DOM.</p><h3 id=react-testing-library><a href=#react-testing-library>react-testing-library <a href=#react-testing-library></a></a></h3><p>In order to write more maintainable tests which also resemble more closely the way our component is used in real life, we have included <a href=https://github.com/testing-library/react-testing-library>react-testing-library</a>. This library renders our component within an actual DOM and provides utilities for querying it.</p><p>Let&rsquo;s give it a go with our <code>&lt;Button /></code> component, shall we? First, let&rsquo;s check that it renders our component with its children, if any, and second that it handles clicks.</p><p>This is our test setup:</p><pre><code class=language-javascript>import React from 'react';
import { render, fireEvent } from 'react-testing-library';
import Button from '../Button';

describe('&lt;Button /&gt;', () =&gt; {
  it('renders and matches the snapshot', () =&gt; {});

  it('handles clicks', () =&gt; {});
});
</code></pre><h4 id=snapshot-testing><a href=#snapshot-testing>Snapshot testing <a href=#snapshot-testing></a></a></h4><p>Let&rsquo;s start by ensuring that it renders our component and no changes happened to it since the last time it was successfully tested.</p><p>We will do so by rendering the component and creating a <em><a href=https://jestjs.io/docs/en/snapshot-testing>snapshot</a></em> which can be compared with a previously committed snapshot. If no snapshot exists, a new one is created.</p><p>For this, we first call <code>render</code>. This will render our <code>&lt;Button /></code> component into a <em>container</em>, by default a <code>&lt;div></code>, which is appended to <code>document.body</code>. We then create a snapshot and <code>expect</code> that this snapshot is the same as the existing snapshot, taken in a previous run of this test and committed to the repository.</p><pre><code class=language-javascript>it('renders and matches the snapshot', () =&gt; {
  const text = 'Click me!';
  const { container } = render(&lt;Button&gt;{text}&lt;/Button&gt;);

  expect(container.firstChild).toMatchSnapshot();
});
</code></pre><p><code>render</code> returns an object that has a property <code>container</code> and yes, this is the container our <code>&lt;Button /></code> component has been rendered in.</p><p>As this is rendered within a <em>normal</em> DOM we can query our component with <code>container.firstChild</code>. This will be our subject for a snapshot. Snapshots are placed in the <code>__snapshots__</code> folder within our <code>tests</code> folder. Make sure you commit these snapshots to your repository.</p><p>So, now if anyone makes any change to our <code>&lt;Button /></code> component the test will fail and we get notified of what changed.</p><p><strong>Further reading:</strong></p><ul><li><a href=https://jestjs.io/blog/2016/07/27/jest-14.html#why-snapshot-testing>Why snapshot testing?</a></li></ul><h4 id=behavior-testing><a href=#behavior-testing>Behavior testing <a href=#behavior-testing></a></a></h4><p>Onwards to our last and most advanced test: checking that our <code>&lt;Button /></code> handles clicks correctly.</p><p>We&rsquo;ll use a <a href=https://jestjs.io/docs/en/mock-functions>mock function</a> for this. A mock function is a function that keeps track of <em>if</em>, <em>how often</em>, and <em>with what arguments</em> it has been called. We pass this function as the <code>onClick</code> handler to our component, simulate a click and, lastly, check that our mock function was called:</p><pre><code class=language-javascript>it('handles clicks', () =&gt; {
  const onClickMock = jest.fn();
  const text = 'Click me!';
  const { getByText } = render(&lt;Button onClick={onClickMock}&gt;{text}&lt;/Button&gt;);

  fireEvent.click(getByText(text));
  expect(onClickSpy).toHaveBeenCalledTimes(1);
});
</code></pre><p>Our finished test file looks like this:</p><pre><code class=language-javascript>import React from 'react';
import { render, fireEvent } from 'react-testing-library';
import Button from '../Button';

describe('&lt;Button /&gt;', () =&gt; {
  it('renders and matches the snapshot', () =&gt; {
    const text = 'Click me!';
    const { container } = render(&lt;Button&gt;{text}&lt;/Button&gt;);

    expect(container.firstChild).toMatchSnapshot();
  });

  it('handles clicks', () =&gt; {
    const onClickMock = jest.fn();
    const text = 'Click me!';
    const { getByText } = render(&lt;Button onClick={onClickMock}&gt;{text}&lt;/Button&gt;);

    fireEvent.click(getByText(text));
    expect(onClickSpy).toHaveBeenCalledTimes(1);
  });
});
</code></pre><h2 id=integration-testing><a href=#integration-testing>Integration testing <a href=#integration-testing></a></a></h2><p>The unit and component testing might ensure the single responisibilty of a function or a UI component but we cannot guarantee they work as expected when being integrated as a whole. That&rsquo;s why integration testing comes in to confirm that an aggregate of a system works together correctly or otherwise exposes errorous behavior between two or more units of code.</p><p>You can choose to write integration tests by using <a href=https://testing-library.com/docs/react-testing-library/intro/>React testing library</a> or <a href=https://www.cypress.io/>Cypress</a>. The test should aim to resemble user&rsquo;s persepective, how users access information on the app and interact with available controls in a stimulate browser. Below is an example of testing the sign-up flow with Cypress:</p><pre><code class=language-js>describe('User Sign-up and Login', () =&gt; {
  it('should redirect unauthenticated user to login page', () =&gt; {
    cy.visit('/');
    cy.location('pathname').should('equal', '/login');
  });

  it('should redirect unauthenticated user to login page', function () {
    cy.visit('/forms');
    cy.location('pathname').should('equal', '/login');
  });

  it('should allow a visitor to sign-up, login, and logout', function () {
    const userInfo = {
      email: 'test@d.foundation',
      password: 'test',
    };

    cy.visit('/');
    cy.get('[name=&quot;email&quot;]').type(userInfo.email);
    cy.get('[name=&quot;password&quot;]').type(userInfo.password).type('{enter}');
    cy.location('pathname').should('equal', '/');
    cy.get('[data-testid=&quot;profile-button&quot;]').click();
    cy.get('[data-testid=&quot;logout-button&quot;]').click();
    cy.location('pathname').should('equal', '/login');
  });
});
</code></pre><p>If the test requires API calls, make sure they are mocked up to work <strong>without the need of a real server</strong>.</p><p>Here&rsquo;s an example of an integration test that uses <a href=https://testing-library.com/docs/react-testing-library/intro/>React Testing Library</a> and <a href=https://github.com/mswjs/msw>Mock Service Worker</a>:</p><pre><code class=language-js>import { setupWorker, rest } from 'msw';

const worker = setupWorker(
  rest.post('/login', (req, res, ctx) =&gt; {
    return res(
      ctx.delay(1500),
      ctx.status(202, 'Mocked status'),
      ctx.json({
        message: 'Mocked response JSON body',
      }),
    );
  }),
);

worker.start();
</code></pre><p>And here&rsquo;s how to use Cypress and intercept the network request for an integration test:</p><pre><code class=language-js>// requests to '/login' will be fulfilled
// with a body of &quot;success&quot;
cy.intercept('/login', 'Mocked response JSON body');
</code></pre><p>Note: sometimes, it&rsquo;s required to have e2e tests by making requests against a real backend server. In that case, we need to ensure network latency and availability of the server are not the factor causing the test to fail.</p><h2 id=read-on><a href=#read-on>Read on: <a href=#read-on></a></a></h2><ul><li><a href=/playbook/engineering/frontend/tech-ecosystem/>Tech ecosystem</a></li><li><a href=/playbook/engineering/frontend/code-style/>Code style</a></li><li><a href=/playbook/engineering/frontend/ui-checklist/>UI checklist</a></li><li><a href=/playbook/engineering/frontend/logging-monitoring/>Logging and monitoring</a></li></ul></main></div><footer><span><b>Dwarves, LLC</b> © 2015 - 2023 All rights reserved.</span></footer><script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/components/prism-core.min.js></script><script src=https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/autoloader/prism-autoloader.min.js></script></body></html>